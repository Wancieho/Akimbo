!function(t){t.Akimbo={},t.App={},t.App.Pages={},t.App.Components={},t.App.Services={},t.App.Classes={},t.App.Config={},document.onreadystatechange=function(){"complete"===this.readyState&&new t.Akimbo.Main}}(this),function(t){function e(){null===n&&(n=this,this.router=new t.Akimbo.Router,o(this))}function o(t){var e="";""!==window.location.hash&&(e=window.location.hash.replace("#","")),t.router.navigate(e)}t.Akimbo.Main=e;var n=null}(this),function(t){function e(){s=this,s.event=new t.Akimbo.Event}function o(t,e){t.name=e,$("["+t.meta.selector+"]").load(t.meta.templateUrl,function(){$("a").on("click",function(t){t.preventDefault()}),void 0===t.meta.templates?n(t):(t.templatesLoaded=0,$.each(t.meta.templates,function(e){i.apply(t,[t.meta.templates[e]])}))})}function n(e){void 0!==e.constructor&&setTimeout(function(){e.constructor(e)},100),void 0!==e.before&&setTimeout(function(){e.before(e)},100),void 0!==e.after&&setTimeout(function(){e.after(e)},150),$("["+e.meta.selector+"]").fadeIn(200),void 0!==e.meta.components&&e instanceof t.App.Core==!1&&s.loadComponents(e.meta.components)}function i(t){var e=this;$.ajax({url:t.template}).done(function(o){t.html=o,++e.templatesLoaded===$.map(e.meta.templates,function(t,e){return[t]}).length&&n(e)})}t.Akimbo.Component=e;var a=[],s=null,r=!1;e.prototype={load:function(e){if(void 0===e)throw'"'+e+'" not found';var n=new e,i=JSON.parse(JSON.stringify(n));if(n.getDefaultInstance=function(){return i},a.unshift(n),n instanceof t.App.Core==!1){if(void 0===n.meta)throw'"'+n.constructor.name+'" meta property must be defined';if(void 0===n.meta.selector)throw'"'+n.constructor.name+'" meta property selector must be defined';if(void 0===n.meta.templateUrl||""===n.meta.templateUrl)throw'"'+n.constructor.name+'" meta property templateUrl must be defined';void 0===n.meta.layout&&(n.meta.layout="index"),r?o(n,n.constructor.name):$("[data-layout]").load("src/app/layouts/"+n.meta.layout+".html",function(){r=!0,s.event.broadcast("layout.loaded")})}return s.event.listen("layout.loaded",function(){n instanceof t.App.Core==!1&&o(n,n.constructor.name)}),n},loadComponents:function(t){$.each(t,function(t,e){s.load(e)})},setLayoutHasLoaded:function(t){r=t},unload:function(){$.each(a,function(t,e){void 0!==e.unload&&e.unload(),$("["+e.meta.selector+"]").empty().remove(),delete $("["+e.meta.selector+"]"),delete(e=null)}),a=[],$("[data-layout]").empty()}}}(this),function(t){function e(){null===o&&(o=this)}t.Akimbo.Config=e;var o=null;e.prototype={get:function(o){if("routes"===o)return(new t.App.Config.Routes).get();if(o.indexOf("settings")!==-1){var n=new e.Settings;if(o.indexOf(".")!==-1){for(var i=o.replace("settings.",""),a=i.split("."),n=n.get(),s=0;s<a.length;s++){if(void 0===n[a[s]])throw'"'+o+'" config does not exist';n=n[a[s]]}return n}return n.get()}}}}(this),function(t){function e(){}t.Akimbo.Event=e;var o=[];e.prototype={listen:function(t,e,n){o.push({event:t,callback:e,object:n})},broadcast:function(t,e,n){void 0===n&&(n=null),$.each(o,function(){var o=!1;this.event.indexOf("*")!==-1&&t.indexOf(this.event.replace("*",""))!==-1&&(o=!0),((void 0===n||null===n)&&t===this.event||void 0!==n&&null!==n&&JSON.stringify(n)===JSON.stringify(this.object)&&t===this.event||o)&&this.callback(e)})},remove:function(t){void 0!==t?$.each(o,function(e){this.event===t&&o.splice(e,1)}):o=[]}}}(this),function(t){function e(){this.config=new t.Akimbo.Config,this.component=new t.Akimbo.Component,this.event=new t.Akimbo.Event}function o(t){c=!0,n.apply(t),i.apply(t),a.apply(t),s.apply(t),c=!1}function n(){this.event.remove(),window.location.hash="#"+l,null!==r&&(this.component.setLayoutHasLoaded(!1),this.component.unload())}function i(){r=new this.component.load(t.App.Core),void 0!==r.constructor&&r.constructor(r),void 0!==r.before&&r.before(r)}function a(){var e=t.App.Pages[u.page];if(void 0===e)throw"root.App.Pages."+u.page+" does not exist";e=new this.component.load(t.App.Pages[u.page]),p&&$("body").removeClass(),void 0!==e.meta&&void 0!==e.meta.templateClass&&$("body").addClass(e.meta.templateClass),e.segments=f}function s(){var t=this;this.event.listen("layout.loaded",function(){new t.component.loadComponents(r.meta.components),setTimeout(function(){void 0!==r.after&&r.after(r)},50)})}t.Akimbo.Router=e;var r=null,c=!1,u={},l="",p=!0,f=[];e.prototype={navigate:function(t,e){var n=this,i=!1;if(f=t.split("/"),p=e!==!1,!c){var a=n.config.get("routes");for(var s in n.config.get("routes"))t===a[s].path&&(i=!0,l=t,u=a[s],o(n));if(!i)throw'"'+t+'" route not found'}},isProtectedRoute:function(){return u.protected}}}(this);